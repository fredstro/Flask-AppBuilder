<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Security &mdash; Flask AppBuilder</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Flask AppBuilder" href="index.html" />
    <link rel="next" title="User Registration" href="user_registration.html" />
    <link rel="prev" title="i18n Translations" href="i18n.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">
  
  <a href="https://github.com/dpgaspar/Flask-AppBuilder"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar  navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Flask-AppBuilder</a>
        <span class="navbar-text navbar-version pull-left"><b>1.6.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="diagrams.html">Diagrams</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="fabmanager.html">Command Line Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Base Configuration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="views.html">Base Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickhowto.html">Model Views (Quick How to)</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickhowto_mongo.html">Model Views on MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickcharts.html">Chart Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickfiles.html">Model Views with Files and Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickminimal.html">Quick Minimal Application</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="relations.html">Model Relations</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="customizing.html">Customizing</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">Templates</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="addons.html">AddOn development</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic_datasource.html">Generic Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="multipledbs.html">Multiple Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">i18n Translations</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_registration.html">User Registration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="versionmigration.html">Version Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Versions</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Security</a><ul>
<li><a class="reference internal" href="#supported-authentication-types">Supported Authentication Types</a></li>
<li><a class="reference internal" href="#role-based">Role based</a></li>
<li><a class="reference internal" href="#permissions">Permissions</a></li>
<li><a class="reference internal" href="#automatic-cleanup">Automatic Cleanup</a></li>
<li><a class="reference internal" href="#auditing">Auditing</a></li>
<li><a class="reference internal" href="#authentication-methods">Authentication Methods</a></li>
<li><a class="reference internal" href="#authentication-database">Authentication: Database</a></li>
<li><a class="reference internal" href="#authentication-openid">Authentication: OpenID</a></li>
<li><a class="reference internal" href="#authentication-ldap">Authentication: LDAP</a></li>
<li><a class="reference internal" href="#authentication-oauth">Authentication: OAuth</a></li>
<li><a class="reference internal" href="#your-custom-security">Your Custom Security</a></li>
<li><a class="reference internal" href="#extending-the-user-model">Extending the User Model</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="i18n.html" title="Previous Chapter: i18n Translations"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; i18n Translat...</span>
    </a>
  </li>
  <li>
    <a href="user_registration.html" title="Next Chapter: User Registration"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">User Registra... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="security">
<h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<div class="section" id="supported-authentication-types">
<h2>Supported Authentication Types<a class="headerlink" href="#supported-authentication-types" title="Permalink to this headline">¶</a></h2>
<p>You have four types of authentication methods</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Database:</th><td class="field-body">username and password style that is queried from the database to match. Passwords are kept hashed on the database.</td>
</tr>
<tr class="field-even field"><th class="field-name">Open ID:</th><td class="field-body">Uses the user&#8217;s email field to authenticate on Gmail, Yahoo etc...</td>
</tr>
<tr class="field-odd field"><th class="field-name">LDAP:</th><td class="field-body">Authentication against an LDAP server, like Microsoft Active Directory.</td>
</tr>
<tr class="field-even field"><th class="field-name">REMOTE_USER:</th><td class="field-body">Reads the <em>REMOTE_USER</em> web server environ var, and verifies if it&#8217;s authorized with the framework users table.
It&#8217;s the web server responsibility to authenticate the user, useful for intranet sites, when the server (Apache, Nginx)
is configured to use kerberos, no need for the user to login with username and password on F.A.B.</td>
</tr>
<tr class="field-odd field"><th class="field-name">OAUTH:</th><td class="field-body">Authentication using OAUTH (v1 or v2). You need to install flask-oauthlib.</td>
</tr>
</tbody>
</table>
<p>Configure the authentication type on config.py, take a look at <a class="reference internal" href="config.html"><span class="doc">Base Configuration</span></a></p>
<p>The session is preserved and encrypted using Flask-Login, OpenID requires Flask-OpenID.</p>
</div>
<div class="section" id="role-based">
<h2>Role based<a class="headerlink" href="#role-based" title="Permalink to this headline">¶</a></h2>
<p>Each user has multiple roles, and a role holds permissions on views and menus, so a user has permissions on views and menus.</p>
<p>There are two special roles, you can define their names on the <a class="reference internal" href="config.html"><span class="doc">Base Configuration</span></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Admin Role:</th><td class="field-body">The framework will assign all the existing permission on views and menus to this role, automatically, this role is for authenticated users only.</td>
</tr>
<tr class="field-even field"><th class="field-name">Public Role:</th><td class="field-body">This is a special role for non authenticated users, you can assign all the permissions on views and menus to this role, and everyone will access specific parts of you application.</td>
</tr>
</tbody>
</table>
<p>Of course you can create any additional role you want and configure them as you like.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User&#8217;s with multiple roles is only possible since 1.3.0 version.</p>
</div>
</div>
<div class="section" id="permissions">
<h2>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h2>
<p>The framework automatically creates for you all the possible existing permissions on your views or menus, by &#8220;inspecting&#8221; your code.</p>
<p>Each time you create a new view based on a model (inherit from ModelView) it will create the following permissions:</p>
<ul class="simple">
<li>can list</li>
<li>can show</li>
<li>can add</li>
<li>can edit</li>
<li>can delete</li>
<li>can download</li>
</ul>
<p>These base permissions will be associated to your view, so if you create a view named &#8220;MyModelView&#8221; you can assign to any role these permissions:</p>
<ul class="simple">
<li>can list on MyModelView</li>
<li>can show on MyModelView</li>
<li>can add on MyModelView</li>
<li>can edit on MyModelView</li>
<li>can delete on MyModelView</li>
<li>can doanload on MyModelView</li>
</ul>
<p>If you extend your view with some exposed method via the &#64;expose decorator and you want to protect it
use the &#64;has_access decorator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModelView</span><span class="p">(</span><span class="n">ModelView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterdace</span><span class="p">(</span><span class="n">Group</span><span class="p">)</span>

    <span class="nd">@has_access</span>
    <span class="nd">@expose</span><span class="p">(</span><span class="s1">&#39;/mymethod/&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">mymethod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># do something</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>The framework will create the following access based on your method&#8217;s name:</p>
<ul class="simple">
<li>can mymethod on MyModelView</li>
</ul>
<p>You can aggregate some of your method&#8217;s on a single permission, this can simplify the security configuration
if there is no need for granular permissions on a group of methods, for this use &#64;permission_name decorator.</p>
<p>You can use the &#64;permission_name to override the permission&#8217;s name to whatever you like.</p>
<p>Take a look at <a class="reference internal" href="api.html"><span class="doc">API Reference</span></a></p>
</div>
<div class="section" id="automatic-cleanup">
<h2>Automatic Cleanup<a class="headerlink" href="#automatic-cleanup" title="Permalink to this headline">¶</a></h2>
<p>All your permissions and views are added automatically to the backend and associated with the &#8216;Admin&#8217; <em>role</em>.
The same applies to removing them. But, if you change the name of a view or menu, the framework
will add the new <em>Views</em> and <em>Menus</em> names to the backend, but will not delete the old ones. It will generate unwanted
names on the security models, basically <em>garbage</em>. To clean them, use the <em>security_cleanup</em> method.</p>
<p>Using security_cleanup is not always necessary, but using it after code rework, will guarantee that the permissions, and
associated permissions to menus and views are exactly what exists on your app. It will prevent orphaned permission names
and associations.</p>
<p>Use the cleanup after you have registered all your views.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">GroupModelView</span><span class="p">,</span> <span class="s2">&quot;List Groups&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Contacts&quot;</span><span class="p">)</span>
<span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">ContactModelView</span><span class="p">,</span> <span class="s2">&quot;List Contacts&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Contacts&quot;</span><span class="p">)</span>
<span class="n">appbuilder</span><span class="o">.</span><span class="n">add_separator</span><span class="p">(</span><span class="s2">&quot;Contacts&quot;</span><span class="p">)</span>
<span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">ContactChartView</span><span class="p">,</span> <span class="s2">&quot;Contacts Chart&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Contacts&quot;</span><span class="p">)</span>
<span class="n">appbuilder</span><span class="o">.</span><span class="n">add_view</span><span class="p">(</span><span class="n">ContactTimeChartView</span><span class="p">,</span> <span class="s2">&quot;Contacts Birth Chart&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;Contacts&quot;</span><span class="p">)</span>

<span class="n">appbuilder</span><span class="o">.</span><span class="n">security_cleanup</span><span class="p">()</span>
</pre></div>
</div>
<p>You can always use it and everything will be painlessly automatic. But if you use it only when needed
(change class name, add <em>security_cleanup</em> to your code, the <em>garbage</em> names are removed, then remove the method)
no overhead is added when starting your site.</p>
</div>
<div class="section" id="auditing">
<h2>Auditing<a class="headerlink" href="#auditing" title="Permalink to this headline">¶</a></h2>
<p>All user&#8217;s creation and modification are audited.
On the show detail for each user you can check who created the user and when and who has last changed it.</p>
<p>You can check also, a total login count (successful login), and the last failed logins
(these are reset if a successful login occurred).</p>
<p>If your using SQLAlchemy you can mix auditing to your models in a simple way. Mix AuditMixin class to your models:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_appbuilder.models.mixins</span> <span class="k">import</span> <span class="n">AuditMixin</span>
<span class="kn">from</span> <span class="nn">flask_appbuilder</span> <span class="k">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span>


<span class="k">class</span> <span class="nc">Project</span><span class="p">(</span><span class="n">AuditMixin</span><span class="p">,</span> <span class="n">Model</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">150</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This will add the following columns to your model:</p>
<ul class="simple">
<li>created_on: The date and time of the record creation.</li>
<li>changed_on: The last date and time of record update.</li>
<li>created_by: Who created the record.</li>
<li>changed_by: Who last modified the record.</li>
</ul>
<p>These columns will be automatically updated by the framework upon creation or update of records. So you should
exclude them from add and edit form. Using our example you will define our view like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProjectModelView</span><span class="p">(</span><span class="n">ModelView</span><span class="p">):</span>
    <span class="n">datamodel</span> <span class="o">=</span> <span class="n">SQLAInterface</span><span class="p">(</span><span class="n">Project</span><span class="p">)</span>
    <span class="n">add_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="n">edit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="authentication-methods">
<h2>Authentication Methods<a class="headerlink" href="#authentication-methods" title="Permalink to this headline">¶</a></h2>
<p>We are now looking at the authentication methods, and how you can configure them and customize them.
The framework as 5 authentication methods and you choose one of them, you configure the method to be used
on the <strong>config.py</strong> (when using the create-app, or following the propused app structure). First the
configuration imports the constants for the authentication methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_appbuilder.security.manager</span> <span class="k">import</span> <span class="n">AUTH_OID</span><span class="p">,</span> \
                                          <span class="n">AUTH_REMOTE_USER</span><span class="p">,</span> \
                                          <span class="n">AUTH_DB</span><span class="p">,</span> <span class="n">AUTH_LDAP</span><span class="p">,</span> \
                                          <span class="n">AUTH_OAUTH</span><span class="p">,</span> \
                                          <span class="n">AUTH_OAUTH</span>
</pre></div>
</div>
<p>Next you will use the <strong>AUTH_TYPE</strong> key to choose the type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_TYPE</span> <span class="o">=</span> <span class="n">AUTH_DB</span>
</pre></div>
</div>
<p>Additionally you can customize the name of the builtin roles for Admin and Public accesses:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_ROLE_ADMIN</span> <span class="o">=</span> <span class="s1">&#39;My Admin Role Name&#39;</span>
<span class="n">AUTH_ROLE_PUBLIC</span> <span class="o">=</span> <span class="s1">&#39;My Public Role Name&#39;</span>
</pre></div>
</div>
<p>Finally you can allow users to self register (take a look at the following chapters for further detail):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_USER_REGISTRATION</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">AUTH_USER_REGISTRATION_ROLE</span> <span class="o">=</span> <span class="s2">&quot;My Public Role Name&quot;</span>
</pre></div>
</div>
<p>These settings can apply to all the authentication methods. When you create your first admin user
using <strong>fabmanager</strong> command line, this user will be authenticated using the authentication method
defined on your <strong>config.py</strong>.</p>
</div>
<div class="section" id="authentication-database">
<h2>Authentication: Database<a class="headerlink" href="#authentication-database" title="Permalink to this headline">¶</a></h2>
<p>The database authentication type is the most <em>simple</em> one, it authenticates users against an
username and hashed password field kept on your database.</p>
<p>Administrators can create users with passwords, and users can change their passwords. This is all done using the UI.
(You can override and extend the default UI as we&#8217;ll see on <em>Your Custom Security</em>)</p>
</div>
<div class="section" id="authentication-openid">
<h2>Authentication: OpenID<a class="headerlink" href="#authentication-openid" title="Permalink to this headline">¶</a></h2>
<p>This authentication method uses <a class="reference external" href="https://github.com/mitsuhiko/flask-openid">Flask-OpenID</a>. All configuration is done
on <strong>config.py</strong> using OPENID_PROVIDERS key, just add or remove from the list the providers you want to enable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_TYPE</span> <span class="o">=</span> <span class="n">AUTH_OID</span>
<span class="n">OPENID_PROVIDERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Yahoo&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://me.yahoo.com&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;AOL&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://openid.aol.com/&lt;username&gt;&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Flickr&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.flickr.com/&lt;username&gt;&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;MyOpenID&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://www.myopenid.com&#39;</span> <span class="p">}]</span>
</pre></div>
</div>
<p>Each list entry is a dict with a readable OpenID name and it&#8217;s url, if the url needs an username just add it using &lt;username&gt;.
The login template for this method will provide a text box for the user to fillout his/her username.</p>
<p>F.A.B. will ask for the &#8216;email&#8217; from OpenID, and if this email belongs to some user on your application he/she will login successfully.</p>
</div>
<div class="section" id="authentication-ldap">
<h2>Authentication: LDAP<a class="headerlink" href="#authentication-ldap" title="Permalink to this headline">¶</a></h2>
<p>This method will authenticate the user&#8217;s credentials against an LDAP server. Using this method without self user registration
is very simple, for MSFT AD just define the LDAP server:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_TYPE</span> <span class="o">=</span> <span class="n">AUTH_LDAP</span>
<span class="n">AUTH_LDAP_SERVER</span> <span class="o">=</span> <span class="s2">&quot;ldap://ldapserver.local&quot;</span>
</pre></div>
</div>
<p>For OpenLDAP or if you need/want to bind first with a query LDAP user,
then using username to search the LDAP server and binding to it (using the user provided password):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_TYPE</span> <span class="o">=</span> <span class="n">AUTH_LDAP</span>
<span class="n">AUTH_LDAP_SERVER</span> <span class="o">=</span> <span class="s2">&quot;ldap://ldapserver.local&quot;</span>
<span class="n">AUTH_LDAP_SEARCH</span> <span class="o">=</span> <span class="s2">&quot;dc=domain,dc=local&quot;</span>
<span class="n">AUTH_LDAP_BIND_USER</span> <span class="o">=</span> <span class="s2">&quot;CN=Query User,OU=People,dc=domain,dc=local&quot;</span>
<span class="n">AUTH_LDAP_BIND_PASSWORD</span> <span class="o">=</span> <span class="s2">&quot;password&quot;</span>
</pre></div>
</div>
<p>for MSFT AD users will be authenticated using the attribute &#8216;userPrincipalName&#8217;, so username&#8217;s will be of the form
<a class="reference external" href="mailto:'someuser&#37;&#52;&#48;somedomail&#46;local">'someuser<span>&#64;</span>somedomail<span>&#46;</span>local</a>&#8216;. Since 1.6.1 you can use a new configuration to set all domains to a certain default,
this will allow users to authenticate using &#8216;someuser&#8217; be setting:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_LDAP_APPEND_DOMAIN</span> <span class="o">=</span> <span class="s1">&#39;somedomain.local&#39;</span>
</pre></div>
</div>
<p>When using self user registration, you can use the following to config further:</p>
<ul class="simple">
<li>AUTH_LDAP_UID_FIELD: Default to &#8216;uid&#8217; will be used to search the user on the LDAP server. For MSFT AD you can set it to &#8216;userPrincipalName&#8217;</li>
<li>AUTH_LDAP_FIRSTNAME_FIELD: Default to &#8216;givenName&#8217; will use MSFT AD attribute to register first_name on the db.</li>
<li>AUTH_LDAP_LASTTNAME_FIELD: Default to &#8216;sn&#8217; will use MSFT AD attribute to register last_name on the db.</li>
<li>AUTH_LDAP_EMAIL_FIELD: Default to &#8216;mail&#8217; will use MSFT AD attribute to register email on the db. If this attribute is null the framework will register &lt;username + <a class="reference external" href="mailto:'&#37;&#52;&#48;email&#46;notfound'">'<span>&#64;</span>email<span>&#46;</span>notfound'</a>&gt;</li>
<li>AUTH_LDAP_SEARCH: This must be set when using self user registration.</li>
</ul>
</div>
<div class="section" id="authentication-oauth">
<h2>Authentication: OAuth<a class="headerlink" href="#authentication-oauth" title="Permalink to this headline">¶</a></h2>
<p>By using this method it will be possible to use the provider API, this is because your requesting the user to give
permission to your app to access or manage the user&#8217;s account on the provider.</p>
<p>So you can send tweets, post on the users facebook, retrieve the user&#8217;s linkedin profile etc.</p>
<p>To use OAuth you need to install <a class="reference external" href="https://flask-oauthlib.readthedocs.org/en/latest/">Flask-OAuthLib</a>. It&#8217;s usefull
to get to know this library since F.A.B. will expose the remote application object for you to play with.</p>
<p>Take a look at the <a class="reference external" href="https://github.com/dpgaspar/Flask-AppBuilder/tree/master/examples/oauth">example</a>
to get an idea of a simple use for this.</p>
<p>Use <strong>config.py</strong> configure OAUTH_PROVIDERS with a list of oauth providers, notice that the remote_app
key is just the configuration for flask-oauthlib:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">AUTH_TYPE</span> <span class="o">=</span> <span class="n">AUTH_OAUTH</span>

<span class="n">OAUTH_PROVIDERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;twitter&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">:</span><span class="s1">&#39;fa-twitter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;remote_app&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;consumer_key&#39;</span><span class="p">:</span><span class="s1">&#39;TWITTER KEY&#39;</span><span class="p">,</span>
            <span class="s1">&#39;consumer_secret&#39;</span><span class="p">:</span><span class="s1">&#39;TWITTER SECRET&#39;</span><span class="p">,</span>
            <span class="s1">&#39;base_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://api.twitter.com/1.1/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;request_token_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://api.twitter.com/oauth/request_token&#39;</span><span class="p">,</span>
            <span class="s1">&#39;access_token_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://api.twitter.com/oauth/access_token&#39;</span><span class="p">,</span>
            <span class="s1">&#39;authorize_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://api.twitter.com/oauth/authenticate&#39;</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;google&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">:</span><span class="s1">&#39;fa-google&#39;</span><span class="p">,</span> <span class="s1">&#39;token_key&#39;</span><span class="p">:</span><span class="s1">&#39;access_token&#39;</span><span class="p">,</span>
        <span class="s1">&#39;remote_app&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;consumer_key&#39;</span><span class="p">:</span><span class="s1">&#39;GOOGLE KEY&#39;</span><span class="p">,</span>
            <span class="s1">&#39;consumer_secret&#39;</span><span class="p">:</span><span class="s1">&#39;GOOGLE SECRET&#39;</span><span class="p">,</span>
            <span class="s1">&#39;base_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://www.googleapis.com/plus/v1/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;request_token_params&#39;</span><span class="p">:{</span>
              <span class="s1">&#39;scope&#39;</span><span class="p">:</span> <span class="s1">&#39;https://www.googleapis.com/auth/userinfo.email&#39;</span>
            <span class="p">},</span>
            <span class="s1">&#39;request_token_url&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;access_token_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://accounts.google.com/o/oauth2/token&#39;</span><span class="p">,</span>
            <span class="s1">&#39;authorize_url&#39;</span><span class="p">:</span><span class="s1">&#39;https://accounts.google.com/o/oauth2/auth&#39;</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This needs a small explanation, you basically have five special keys:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">name:</th><td class="field-body">The name of the provider, you can choose whatever you want. But the framework as some
builtin logic to retrieve information about a user that you can make use of if you choose:
&#8216;twitter&#8217;, &#8216;google&#8217;, &#8216;github&#8217;,&#8217;linkedin&#8217;.</td>
</tr>
<tr class="field-even field"><th class="field-name">icon:</th><td class="field-body">The font-awesome icon for this provider.</td>
</tr>
<tr class="field-odd field"><th class="field-name">token_key:</th><td class="field-body">The token key name that this provider uses, google and github uses <em>&#8216;access_token&#8217;</em>,
twitter uses <em>&#8216;oauth_token&#8217;</em> and thats the default.</td>
</tr>
<tr class="field-even field"><th class="field-name">token_secret:</th><td class="field-body">The token secret key name, default is <em>&#8216;oauth_token_secret&#8217;</em></td>
</tr>
</tbody>
</table>
<p>After the user authenticates and grants access permissions to your application
the framework retrieves information about the user, username and email. This info
will be checked with the internal user (user record on User Model), first by username next by email.</p>
<p>To override/customize the user information retrieval from oauth, you can create your own method like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nd">@appbuilder</span><span class="o">.</span><span class="n">sm</span><span class="o">.</span><span class="n">oauth_user_info_getter</span>
<span class="k">def</span> <span class="nf">my_user_info_getter</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">provider</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">provider</span> <span class="o">==</span> <span class="s1">&#39;github&#39;</span><span class="p">:</span>
        <span class="n">me</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">oauth_remotes</span><span class="p">[</span><span class="n">provider</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">me</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
</pre></div>
</div>
<p>Decorate your method with the SecurityManager <strong>oauth_user_info_getter</strong> decorator.
Make your method accept the exact parameters as on this example, and then return a dictionary
with the retrieved user information. The dictionary keys must have the same column names as the User Model.
Your method will be called after the user authorizes your application on the OAuth provider, and it will
receive the following: <strong>sm</strong> is F.A.B&#8217;s SecurityManager class, <strong>provider</strong> is a string with the name you configured
this provider with, <strong>response</strong> is the response.</p>
<p>Take a look at the <a class="reference external" href="https://github.com/dpgaspar/Flask-AppBuilder/tree/master/examples/oauth">example</a></p>
</div>
<div class="section" id="your-custom-security">
<h2>Your Custom Security<a class="headerlink" href="#your-custom-security" title="Permalink to this headline">¶</a></h2>
<p>If you want to alter the security views, or authentication methods since (1.0.1) you can do it in a simple way.
The <strong>AppBuilder</strong> has a new optional initialization parameter where you pass your own custom <strong>SecurityManager</strong>
If you want to add, for example, actions to the list of users you can do it in a simple way.</p>
<p>First i advise you to create security.py and add the following to it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="k">import</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">flask_appbuilder.security.views</span> <span class="k">import</span> <span class="n">UserDBModelView</span>
<span class="kn">from</span> <span class="nn">flask_appbuilder.security.sqla.manager</span> <span class="k">import</span> <span class="n">SecurityManager</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.actions</span> <span class="k">import</span> <span class="n">action</span>


<span class="k">class</span> <span class="nc">MyUserDBView</span><span class="p">(</span><span class="n">UserDBModelView</span><span class="p">):</span>
    <span class="nd">@action</span><span class="p">(</span><span class="s2">&quot;muldelete&quot;</span><span class="p">,</span> <span class="s2">&quot;Delete&quot;</span><span class="p">,</span> <span class="s2">&quot;Delete all Really?&quot;</span><span class="p">,</span> <span class="s2">&quot;fa-rocket&quot;</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">muldelete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">delete_all</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_redirect</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_redirect</span><span class="p">())</span>


<span class="k">class</span> <span class="nc">MySecurityManager</span><span class="p">(</span><span class="n">SecurityManager</span><span class="p">):</span>
    <span class="n">userdbmodelview</span> <span class="o">=</span> <span class="n">MyUserDBView</span>
</pre></div>
</div>
<p>Then on the __init__.py initialize AppBuilder with you own security class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">appbuilder</span> <span class="o">=</span> <span class="n">AppBuilder</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">security_manager_class</span><span class="o">=</span><span class="n">MySecurityManager</span><span class="p">)</span>
</pre></div>
</div>
<p>F.A.B. uses a different user view for each authentication method</p>
<ul class="simple">
<li>UserDBModelView - for database auth method</li>
<li>UserOIDModelView - for Open ID auth method</li>
<li>UserLDAPModelView - for LDAP auth method</li>
</ul>
<p>You can extend or create from scratch your own, and then tell F.A.B. to use them instead, by overriding their
correspondent lower case properties on <strong>SecurityManager</strong> (just like on the given example).</p>
<p>Take a look and run the example on <a class="reference external" href="https://github.com/dpgaspar/Flask-AppBuilder/tree/master/examples/employees">Employees example</a></p>
<p>Study the source code of <a class="reference external" href="https://github.com/dpgaspar/Flask-AppBuilder/blob/master/flask_appbuilder/security/manager.py">BaseSecurityManager</a></p>
</div>
<div class="section" id="extending-the-user-model">
<h2>Extending the User Model<a class="headerlink" href="#extending-the-user-model" title="Permalink to this headline">¶</a></h2>
<p>If you want to extend the <strong>User</strong> Model with extra columns specific to your application (since 1.3.0) you
can easily do it. Use the same type of approach as explained earlier.</p>
<p>First extend the User Model (create a sec_models.py file):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_appbuilder.security.sqla.models</span> <span class="k">import</span> <span class="n">User</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="k">import</span> <span class="n">relationship</span><span class="p">,</span> <span class="n">backref</span>
<span class="kn">from</span> <span class="nn">flask_appbuilder</span> <span class="k">import</span> <span class="n">Model</span>

<span class="k">class</span> <span class="nc">MyUser</span><span class="p">(</span><span class="n">User</span><span class="p">):</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span>
</pre></div>
</div>
<p>Next define a new User view, just like the default User view but with the extra column (create a sec_view.py)
If your using:</p>
<ul class="simple">
<li>AUTH_DB extend UserDBModelView</li>
<li>AUTH_LDAP extend UserLDAPModelView</li>
<li>AUTH_REMOTE_USER extend UserRemoteUserModelView</li>
<li>AUTH_OID extend UserOIDModelView</li>
<li>AUTH_OAUTH extend UserOAuthModelView</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_appbuilder.security.views</span> <span class="k">import</span> <span class="n">UserDBModelView</span>
<span class="kn">from</span> <span class="nn">flask_babelpkg</span> <span class="k">import</span> <span class="n">lazy_gettext</span>

<span class="k">class</span> <span class="nc">MyUserDBModelView</span><span class="p">(</span><span class="n">UserDBModelView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        View that add DB specifics to User view.</span>
<span class="sd">        Override to implement your own custom view.</span>
<span class="sd">        Then override userdbmodelview property on SecurityManager</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">show_fieldsets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">lazy_gettext</span><span class="p">(</span><span class="s1">&#39;User info&#39;</span><span class="p">),</span>
         <span class="p">{</span><span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">,</span> <span class="s1">&#39;login_count&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">]}),</span>
        <span class="p">(</span><span class="n">lazy_gettext</span><span class="p">(</span><span class="s1">&#39;Personal Info&#39;</span><span class="p">),</span>
         <span class="p">{</span><span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">],</span> <span class="s1">&#39;expanded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}),</span>
        <span class="p">(</span><span class="n">lazy_gettext</span><span class="p">(</span><span class="s1">&#39;Audit Info&#39;</span><span class="p">),</span>
         <span class="p">{</span><span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;last_login&#39;</span><span class="p">,</span> <span class="s1">&#39;fail_login_count&#39;</span><span class="p">,</span> <span class="s1">&#39;created_on&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;created_by&#39;</span><span class="p">,</span> <span class="s1">&#39;changed_on&#39;</span><span class="p">,</span> <span class="s1">&#39;changed_by&#39;</span><span class="p">],</span> <span class="s1">&#39;expanded&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}),</span>
    <span class="p">]</span>

    <span class="n">user_show_fieldsets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">lazy_gettext</span><span class="p">(</span><span class="s1">&#39;User info&#39;</span><span class="p">),</span>
         <span class="p">{</span><span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">,</span> <span class="s1">&#39;login_count&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">]}),</span>
        <span class="p">(</span><span class="n">lazy_gettext</span><span class="p">(</span><span class="s1">&#39;Personal Info&#39;</span><span class="p">),</span>
         <span class="p">{</span><span class="s1">&#39;fields&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">],</span> <span class="s1">&#39;expanded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}),</span>
    <span class="p">]</span>

    <span class="n">add_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;conf_password&#39;</span><span class="p">]</span>
    <span class="n">list_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">]</span>
    <span class="n">edit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;roles&#39;</span><span class="p">,</span> <span class="s1">&#39;extra&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Next create your own SecurityManager class, overriding your model and view for User (create a sec.py):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_appbuilder.security.sqla.manager</span> <span class="k">import</span> <span class="n">SecurityManager</span>
<span class="kn">from</span> <span class="nn">.sec_models</span> <span class="k">import</span> <span class="n">MyUser</span>
<span class="kn">from</span> <span class="nn">.sec_views</span> <span class="k">import</span> <span class="n">MyUserDBModelView</span>

<span class="k">class</span> <span class="nc">MySecurityManager</span><span class="p">(</span><span class="n">SecurityManager</span><span class="p">):</span>
    <span class="n">user_model</span> <span class="o">=</span> <span class="n">MyUser</span>
    <span class="n">userdbmodelview</span> <span class="o">=</span> <span class="n">MyUserDBModelView</span>
</pre></div>
</div>
<p>Note that this is for AUTH_DB, so if your using:</p>
<ul class="simple">
<li>AUTH_DB override userdbmodelview</li>
<li>AUTH_LDAP override userldapmodelview</li>
<li>AUTH_REMOTE_USER override userremoteusermodelview</li>
<li>AUTH_OID override useroidmodelview</li>
</ul>
<p>Finally (as shown on the previous example) tell F.A.B. to use your SecurityManager class, so when initializing
<strong>AppBuilder</strong> (on __init__.py):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="k">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder</span> <span class="k">import</span> <span class="n">SQLA</span><span class="p">,</span> <span class="n">AppBuilder</span>
<span class="kn">from</span> <span class="nn">flask.ext.appbuilder.menu</span> <span class="k">import</span> <span class="n">Menu</span>
<span class="kn">from</span> <span class="nn">.sec</span> <span class="k">import</span> <span class="n">MySecurityManager</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLA</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">appbuilder</span> <span class="o">=</span> <span class="n">AppBuilder</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">menu</span><span class="o">=</span><span class="n">Menu</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">security_manager_class</span><span class="o">=</span><span class="n">MySecurityManager</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">app</span> <span class="k">import</span> <span class="n">views</span>
</pre></div>
</div>
<p>Now you&#8217;ll have your extended User model as the authenticated user, <em>g.user</em> will have your model with the extra col.</p>
<p>Some images:</p>
<a class="reference internal image-reference" href="_images/security.png"><img alt="_images/security.png" src="_images/security.png" style="width: 100%;" /></a>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013, Daniel Vaz Gaspar.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>